<!-- AWP_In_Variable Name='"DB_WEBSERVER".Auto_Man' -->
<!-- AWP_In_Variable Name='"IOMotor".Run_CMD' -->
<!-- AWP_In_Variable Name='"IOMotor".Power' -->
<!-- AWP_In_Variable Name='"DB_WEBSERVER".inserirpeca' -->
<!-- AWP_In_Variable Name='"DB_WEBSERVER".SPPeca' -->
<!-- AWP_In_Variable Name='"DB_WEBSERVER".SPTanque' -->
<!-- AWP_In_Variable Name='"DB_WEBSERVER".bCadastrarPeca' -->

<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>KMCC</title>
    
	<script src="raphael-2.1.4.min.js"></script>
    <script src="justgage.js"></script>	
    <script src="jquery-3.2.1.min.js"></script>
	<link rel="stylesheet" href="mystyle.css"> 
    <link rel="stylesheet" href="switch.css" type="text/css" media="screen" />
    
</head>
<body>
    <div id="container">
        <div id="header">
            <div class="title1">Controle de Vulcanização</div>
			<img src="ndblogo.png" alt="Descrição da Imagem" id="pos_logo" />
            <!-- <div class="title2"></div> -->
			
			<div align="right" id="DateNow">12:0:0 PM</div>
        </div>	
		
        <div id="content">
			
			<div id="pos1">				
				<h3>Inserir Peça Manual</h3>
				<table frame="box" cellpadding="6px" cellspacing="3px" bgcolor="LightGray" align="center" >					
					<tr>
						<th align="left" style="text-align:justify" title="ON=Auto, OFF=Man">Auto/Manual 							
						</th>
						<th class="switch"><span class="thumb"> </span><input type="checkbox" id='"DB_WEBSERVER".Auto_Man'/>
						</th>
					</tr>						
					<tr>
						<th align="left" title="0 - 999">Inserir Peça 							
						</th>						
						<th>
							<input size="6" type="text"  min="0.0" max="100.0" style="text-align:center" id="SPPeca" class="input-field"> 								
						</th>				
					</tr>
					<tr>
						<th align="left" title="0 - 100">Inserir Tanque							
						</th>						
						<th>
							<input size="6" type="text"  min="0.0" max="100.0" style="text-align:center" id="SPTanque" class="input-field"> 								
						</th>				
					</tr>
					<tr>
						<th align="left" title="0 - 100">Tempo Flange							
						</th>						
						<th>
							<input size="6" type="text"  min="0.0" max="100.0" style="text-align:center" id="SPTanque" class="input-field"> 								
						</th>				
					</tr>
					<tr>
						<th align="left" title="0 - 100">Tempo Vulcanização							
						</th>						
						<th>
							<input size="6" type="text"  min="0.0" max="100.0" style="text-align:center" id="SPTanque" class="input-field"> 								
						</th>				
					</tr>
					<tr>											
						<th>
							<form>
								<input type="submit" value="Cadastrar" class="button button-on" >
								<input type="hidden" name='"DB_WEBSERVER".bCadastrarPeca' value="1">
							</form>								
						</th>				
					</tr>
					
						
									
				</table>
			</div>
            <div id="pos2">				
				<h3>Monitoring</h3>
				<table border="3px" cellpadding="6px" cellspacing="5px" bgcolor="LightGray" align="center">					
					<tr>
						<th>Status 							
						</th>
						<th style="width:100px" id="Status_Run">Stop							
						</th>	
					</tr>
					<tr>
						<th>Peça Atual					
						</th>
						<th id="peca1">0							
						</th>
					</tr>
					<tr>
						<th>Tanque Atual					
						</th>
						<th id="tanque1">0							
						</th>
					</tr>					
					<tr>
						<th>No run							
						</th>
						<th id="NoRun">0							
						</th>
					</tr>
					
					<tr>
						<th>Speed  							
						</th>
						<th id="Speed_PV">0RPM							
						</th>
						
					</tr>					
				</table>			
			</div>
			<div id="pos3">				
			</div>
			
			
			
        </div>		
		<div id="footer">&copy;2024 KMCC</div>
		</div>

	<script>
		(function() {
			var $$ = function(selector) {
				return Array.prototype.slice.call(document.querySelectorAll(selector));
			}
			document.addEventListener("DOMContentLoaded", function() {
				var checkbox;
				$$(".switch").forEach(function(switchControl) {
					if (switchControl.className === ("switch on")) {
						switchControl.lastElementChild.checked = true;
					}
					switchControl.addEventListener("click", function toggleSwitch() {
						if (switchControl.className === "switch on") {
							switchControl.className = 'switch off';
						} else {
							switchControl.className = ("switch on");
						}
						checkbox = switchControl.lastElementChild;
		
						checkbox.checked = !checkbox.checked;
						//var url = "/" + window.location.pathname.substr(1);
						url="IOServer.htm";
						var ival = +checkbox.checked;
						var sdata = checkbox.id;
						//alert(ival);						
						sdata=escape(sdata)+'='+ival;
						//alert(sdata);
	
	    				$.post(url,sdata,function(result,status){});
						//alert(status);
					}, false);
				});
				
				
				
							
				

				document.getElementById('SPTanque').addEventListener('keypress', function(event1) {				
					if(event1.key=="Enter"){
						var val = document.getElementById('SPTanque').value;
						
                			
							url="IOServer.htm";
							name='"DB_WEBSERVER".SPTanque';
							//val=$('input[id=Power]').val();
							sdata=escape(name)+'='+val;
							//alert(sdata);
							$.post(url,sdata,function(result2){});
					
            			
					}
					return false;
				},false);
				
				document.getElementById('SPPeca').addEventListener('keypress', function(event1) {				
					if(event1.key=="Enter"){
						var val = document.getElementById('SPPeca').value;
						
                			
							url="IOServer.htm";
							name='"DB_WEBSERVER".SPPeca';
							//val=$('input[id=Power]').val();
							sdata=escape(name)+'='+val;
							//alert(sdata);
							$.post(url,sdata,function(result2){});					
            			
					}
					return false;
				},false);	
			
					
					
            	$.ajaxSetup({ cache: false });
        		setInterval(function() {
					url="IOServer.htm";
            		$.getJSON(url, function(result){
					$('#contador').text(result["contador"]);
					$('#peca1').text(result["peca1"]);
					$('#tanque1').text(result["tanque1"]);
                	$('#Speed_PV').text(result["Speed_PV"]+ " RPM");
					$('#NoRun').text(result["No_Run"]);
					
					
					//document.getElementById('Power').value = result["Power"];	
					
					
					
            							
					if(result["Status"]==0){
						$('#Status_Run').text("Stop");
						}
					else{
						$('#Status_Run').text("Running");
						}
					pos3.refresh(result["Speed_PV"].trim());
            		});
					var d = new Date();
					//var n = d.toLocaleDateString();
					var m = d.toLocaleTimeString();
					$('#DateNow').text(m);
        		},1000);
        	
			
				function customValue(val) {				
					if (val < 500) {
						return 'low';
					} else if (val <= 1200) {
						return 'normal';
					} else {					
						return 'high';
					}
				}				
			}, false);
		})()
	</script>
</body>
</html>